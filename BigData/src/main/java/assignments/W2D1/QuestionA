Pair Approach

Mapper
    method Map(docid a; doc d)
        for all term w in doc d do
            for all term u in N(w) do
                Emit((w,0),1)
                Emit((w,u),1)

Reducer
    method Initialize
        int N = 0
    method Reduce((w,u); counts [c1; c2; â€¦])
        int sum = 0
        for all term c in counts
            sum += c
        if(u == 0)
            N = sum
        else
            Emit((w,u),sum/N)

Mapper 1
Input:
15 91 80 12 19 80 18 17 15 80 18 19 18
Output:
((15,0),1)  ((15,91),1) ((15,0),1)  ((15,80),1) ((15,0),1)  ((15,12),1) ((15,0),1)  ((15,19),1)
((15,0),1)  ((15,80),1) ((15,0),1)  ((15,18),1) ((15,0),1)  ((15,17),1)

((91,0),1)  ((91,80),1) ((91,0),1)  ((91,12),1) ((91,0),1)  ((91,19),1) ((91,0),1)  ((91,80),1)
((91,0),1)  ((91,18),1) ((91,0),1)  ((91,17),1) ((91,0),1)  ((91,15),1) ((91,0),1)  ((91,80),1)
((91,0),1)  ((91,18),1) ((91,0),1)  ((91,19),1) ((91,0),1)  ((91,18),1)

((80,0),1)  ((80,12),1) ((80,0),1)  ((80,19),1)

((12,0),1)  ((12,19),1) ((12,0),1)  ((12,80),1) ((12,0),1)  ((12,18),1) ((12,0),1)  ((12,17),1)
((12,0),1)  ((12,15),1) ((12,0),1)  ((12,80),1) ((12,0),1)  ((12,18),1) ((12,0),1)  ((12,19),1)
((12,0),1)  ((12,18),1)

((19,0),1)  ((19,80),1) ((19,0),1)  ((19,18),1) ((19,0),1)  ((19,17),1) ((19,0),1)  ((19,15),1)
((19,0),1)  ((19,80),1) ((19,0),1)  ((19,18),1)

((80,0),1)  ((80,18),1) ((80,0),1)  ((80,17),1) ((80,0),1)  ((80,15),1)

((18,0),1)  ((18,17),1) ((18,0),1)  ((18,15),1) ((18,0),1)  ((18,80),1)

((17,0),1)  ((17,15),1) ((17,0),1)  ((17,80),1) ((17,0),1)  ((17,18),1) ((17,0),1)  ((17,19),1)
((17,0),1)  ((17,18),1)

((15,0),1)  ((15,80),1) ((15,0),1)  ((15,18),1) ((15,0),1)  ((15,19),1) ((15,0),1)  ((15,18),1)

((80,0),1)  ((80,18),1) ((80,0),1)  ((80,19),1) ((80,0),1)  ((80,18),1)
((18,0),1)  ((18,19),1)
((19,0),1)  ((19,18),1)

Mapper 2
Input:
19 15 80 18 19 18 18 15 18 18 88 18
Output:
((19,0),1)  ((19,15),1) ((19,0),1)  ((19,80),1) ((19,0),1)  ((19,18),1)

((15,0),1)  ((15,80),1) ((15,0),1)  ((15,18),1) ((15,0),1)  ((15,19),1) ((15,0),1)  ((15,18),1)
((15,0),1)  ((15,18),1)

((80,0),1)  ((80,18),1) ((80,0),1)  ((80,19),1) ((80,0),1)  ((80,18),1) ((80,0),1)  ((80,18),1)
((80,0),1)  ((80,15),1) ((80,0),1)  ((80,18),1) ((80,0),1)  ((80,18),1) ((80,0),1)  ((80,88),1)
((80,0),1)  ((80,18),1)

((18,0),1)  ((18,19),1)

((19,0),1)  ((19,18),1) ((19,0),1)  ((19,18),1) ((19,0),1)  ((19,15),1) ((19,0),1)  ((19,18),1)
((19,0),1)  ((19,18),1) ((19,0),1)  ((19,88),1) ((19,0),1)  ((19,18),1)

((18,0),1)  ((18,15),1)

((15,0),1)  ((15,18),1) ((15,0),1)  ((15,18),1) ((15,0),1)  ((15,88),1) ((15,0),1)  ((15,18),1)

((18,0),1)  ((18,88),1)
((88,0),1)  ((88,18),1)

Reducer 1
Input:
((12,0),[1,1,1,1,1,1,1,1,1])    9
((12,15),[1])
((12,17),[1])
((12,18),[1,1,1])
((12,19),[1,1])
((12,80),[1,1])

((15,0),[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1])  20
((15,12),[1])
((15,17),[1])
((15,18),[1,1,1,1,1,1,1,1,1])
((15,19),[1,1,1])
((15,80),[1,1,1,1])
((15,88),[1])
((15,91),[1])

((17,0),[1,1,1,1,1])    5
((17,15),[1])
((17,18),[1,1])
((17,19),[1])
((17,80),[1])

((18,0),[1,1,1,1,1,1,1])    7
((18,15),[1,1])
((18,17),[1])
((18,19),[1,1])
((18,80),[1])
((18,88),[1])

((19,0),[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1])  17
((19,15),[1,1,1])
((19,17),[1])
((19,18),[1,1,1,1,1,1,1,1,1])
((19,80),[1,1,1])
((19,88),[1])

((80,0),[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1])    17
((80,12),[1])
((80,15),[1,1])
((80,17),[1])
((80,18),[1,1,1,1,1,1,1,1,1])
((80,19),[1,1,1])
((80,88),[1])

((88,0),[1])
((88,18),[1])

((91,0),[1,1,1,1,1,1,1,1,1,1,1])    11
((91,12),[1])
((91,15),[1])
((91,17),[1])
((91,18),[1,1,1])
((91,19),[1,1])
((91,80),[1,1,1])
Output:
((12,15),1/9)
((12,17),1/9)
((12,18),3/9)
((12,19),2/9)
((12,80),2/9)

((15,12),1/20)
((15,17),1/20)
((15,18),9/20)
((15,19),3/20)
((15,80),4/20)
((15,88),1/20)
((15,91),1/20)

((17,15),1/5)
((17,18),2/5)
((17,19),1/5)
((17,80),1/5)

((18,15),2/7)
((18,17),1/7)
((18,19),2/7)
((18,80),1/7)
((18,88),1/7)

((19,15),3/17)
((19,17),1/17)
((19,18),9/17)
((19,80),3/17)
((19,88),1/17)

((80,12),1/17)
((80,15),2/17)
((80,17),1/17)
((80,18),9/17)
((80,19),3/17)
((80,88),1/17)

((88,18),1)

((91,12),1/11)
((91,15),1/11)
((91,17),1/11)
((91,18),3/11)
((91,19),2/11)
((91,80),3/11)